#cloud-config
users:
  - name: sandbox
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCwgqlGo2ya4TeS4JNULmhNyWV0wXrvQzJjDnSlMKe+VKO0N+7d9fkjWkqhzTaU0hLYlvGUXVzbwgq8uRFHodPqtnr3LG4XchJQjMWrzzNWkiuer8siNImMKFwEKQFTFjBh/rfVKy7u1wBiCd6WluEzVpzKUYiAV+592ZBAsQVCi8CAgo+GEozwAeV/4YoT7GOVqs2i+33XB6+ypa6s2tsw3ZbrsC2W5cZCjFzUCx5+ydxnhqodBXOyPu1bVW3hKQl6XcGnsqEV/ePZdFlMFlOzmTOqkCdtxdsSzyltkWlYTOAcFTqNpZP8fT1D/dT4BdO7c8pcOY3IBqQSTbYJ5TIRpozLilXoambmoQDExv2dp6yPjsm1rRQ7wlgQCPwJR4XDb7l38YGJp+6mIJS9gV6LQ8j17PaoLVdtIs5eYU8FOj5fTrhAjLTdZ8R5SZIjAHwXB3udeEc9H8UUdTO1aqkFs1c2FoTa3M0CFdew+ms3pnM3ejFt/kZc5hNDvKIYzLrlHSKs5WAIBVyh3vO4TJFVOCSQEUUY98LMB7TNJ5siE/GvxGPKa9QpJ5iV6aW1cmec2PZhDDhqh67Z1UOPVBQL4VLqmr8h5OAv9INrCdTWYIogPZCi8PeV/AMZDjFMSZtkil8/wbICfZDXBbWpF+p6siYPi6mzcA5aJ0S1gDzD3Q== slopspotter-sandbox
    lock_passwd: false

# Set password to 'sandbox123'
chpasswd:
  list: |
    sandbox:sandbox123
  expire: false

ssh_pwauth: true

package_update: true
package_upgrade: true

packages:
  - python3
  - python3-pip
  - python3-venv
  - nodejs
  - npm
  - strace
  - tcpdump
  - git
  - curl
  - wget
  - build-essential
  - qemu-guest-agent

runcmd:
  - systemctl enable ssh
  - systemctl start ssh
  - systemctl enable qemu-guest-agent
  - systemctl start qemu-guest-agent
  - pip3 install --upgrade pip
  - pip3 install psutil
  - npm install -g npm@latest
  - echo "VM initialization complete" > /tmp/init-complete
  - date > /tmp/init-timestamp

final_message: "Slopspotter sandbox VM is ready!"
