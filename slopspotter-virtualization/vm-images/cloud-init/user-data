#cloud-config
users:
  - name: sandbox
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCnvZhQD+knoLCGbxTOVDVavR/c50rqSpMa7QBsSrBdDWSRVSVcQmkBNs9vGMlJ6tLVq554XBxrfgBSSAUheKp3wcqatCGviNizjIobhCpmogjEwVBOrNeF0T3x571TO3/lOnVLnBNRk9G/ZIXxYznhQbTymGhmhUaOKV9kCLQE++mgis5h1nY4b9T9Rm31I2AHkt4/c07Ypme3rZ8WnajMySwWzmOfNkk4Xl8K79VKgVe6tOYnSjLDHMC4CRhtoHeA1OnsoKrnBmqvUqNPzzv7vX31Hym0UYzN8e/+IW9UWkyrN6WVrlPKEKPEtivVgSTBMM5vhQZ0Pi1ldYiu0z91N5OusnBEl6FCj7aZEQtwhq5l6Up2+6zDnbk/hGw2I/dVLA/HBQ3b83+Y81CYuF7+IYlm6DyMlZJz+Y7EFHRlIa2CZ9O89i2XJrsAJ5YjcmBAJ0XVpye8DW5WlE64F1SIsHgU6qg/KERPVFuoZHOX5l6IkMHfwAV9IbTR3xa4AJ77qt2Y5C5tmSrm8Uzb6aNdzrCl2i6eiJvgcja0+43IUdRGnrlxme2UlkJd83dKo5j9FRLDk/BZbHpqtXRi1Mnx9Mb4fK8DJr+LXGkl37oSMSKrWbm+01Bxg9fq8LuM9F65LeI/deRcpLdz+87Ym+g81vaiKuNYumzcqAsypU2REQ== slopspotter-sandbox
    lock_passwd: false

# Set password to 'sandbox123'
chpasswd:
  list: |
    sandbox:sandbox123
  expire: false

ssh_pwauth: true

package_update: true
package_upgrade: true

packages:
  - python3
  - python3-pip
  - python3-venv
  - nodejs
  - npm
  - strace
  - tcpdump
  - git
  - curl
  - wget
  - build-essential
  - qemu-guest-agent

runcmd:
  - systemctl enable ssh
  - systemctl start ssh
  - systemctl enable qemu-guest-agent
  - systemctl start qemu-guest-agent
  - pip3 install --upgrade pip
  - pip3 install psutil
  - npm install -g npm@latest
  - echo "VM initialization complete" > /tmp/init-complete
  - date > /tmp/init-timestamp

final_message: "Slopspotter sandbox VM is ready!"
